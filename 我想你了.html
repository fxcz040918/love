<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
<title>äº²çˆ±çš„</title>
<style>
  :root {
    --popup-w: 240px;
    --popup-h: 64px;
    --bg: #ffd1dc;        /* ç²‰è‰² */
    --fg: #333;
  }
  html, body {
    height: 100%;
    margin: 0;
    background: #111;
    font-family: "å¾®è½¯é›…é»‘", "PingFang SC", system-ui, -apple-system, Arial, sans-serif;
    color: #eee;
    overflow: hidden; /* é˜²æ­¢å¼¹çª—æ’‘å‡ºæ»šåŠ¨æ¡ */
  }
  .ui {
    position: fixed; inset: 12px 12px auto 12px;
    display: flex; gap: 8px; flex-wrap: wrap; align-items: center;
    z-index: 10000;
    background: rgba(0,0,0,.35);
    padding: 10px 12px; border-radius: 10px; backdrop-filter: blur(6px);
  }
  .ui > * { font-size: 14px; }
  button {
    border: 0; padding: 8px 14px; border-radius: 8px;
    background: #ff7fa1; color: #fff; font-weight: 700;
  }
  button.secondary { background: #555; }
  input[type="number"]{ width: 80px; padding: 6px 8px; border-radius: 6px; border: 1px solid #444; background:#222; color:#fff; }

  .popup {
    position: fixed; width: var(--popup-w); height: var(--popup-h);
    background: var(--bg); color: var(--fg);
    border-radius: 12px; box-shadow: 0 6px 18px rgba(0,0,0,.25);
    display: flex; align-items: center; justify-content: center;
    text-align: center; padding: 8px 10px; line-height: 1.2;
    user-select: none;
    animation: pop-in .25s ease both;
  }
  .popup .txt { font-size: 18px; font-weight: 700; }
  @keyframes pop-in { from { transform: scale(.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
  @keyframes fade-out { to { transform: scale(.95); opacity: 0; } }

  /* é€‚é…å°å±ï¼šç¼©å°å¼¹çª— */
  @media (max-width: 420px) {
    :root { --popup-w: 180px; --popup-h: 56px; }
    .popup .txt { font-size: 16px; }
  }
</style>
</head>
<body>

<div class="ui">
  <span>æ•°é‡</span>
  <input id="count" type="number" min="1" max="999" value="120" />
  <span>é—´éš”(ms)</span>
  <input id="gap" type="number" min="0" max="5000" value="60" />
  <span>è‡ªåŠ¨å…³é—­(ms)</span>
  <input id="ttl" type="number" min="0" max="10000" value="2000" />
  <button id="startBtn">å¼€å§‹</button>
  <button id="stopBtn" class="secondary">åœæ­¢</button>
</div>

<script>
  // ä½ å¯ä»¥åœ¨è¿™é‡Œè‡ªç”±å¢åˆ æ–‡æ¡ˆ
  const messages = [
    "æƒ³ä½ ä¸‰ç§’é’ŸğŸ’—","ç»™ä½ ä¸€ä¸ªæ‹¥æŠ±ğŸ¤—","ä»Šå¤©è§é¢å—ï¼Ÿ","æ³¨æ„ä¼‘æ¯å“¦ï½","æ—©ç‚¹ç¡å‘€ğŸ’¤",
    "åƒé¥­äº†å—ï¼ŸğŸš","åˆ«ç†¬å¤œå•¦ğŸ¥±","ç»™ä½ åŠ›é‡âš¡","æŠ±ä¸€æŠ±ğŸ’","æ¯”ä¸ªå¿ƒâ¤",
    "æƒ³å’Œä½ èŠå¤©ğŸ’¬","å‘æ¥ä¸€æ¡æƒ³å¿µğŸ’Œ","æ—©å®‰å‘€â˜€ï¸","æ™šå®‰å¥½æ¢¦ğŸŒ™","ä»Šå¤©ä¹Ÿè¦åŠ æ²¹é¸­ï¼ğŸ’ª",
    "å°å¿ƒæ„Ÿå†’ï½ğŸ¥º","ä½ åœ¨çœ‹æˆ‘å—ğŸ‘€","ç»™ä½ å°èŠ±ğŸŒ¸","æƒ³ä½ ä¸€æ•´å¤©ğŸ’—","é€ä½ ä¸ªå¾®ç¬‘ğŸ˜Š",
    "æ‘¸æ‘¸å¤´ï½","æ³¨æ„ä¿æš–ï½","è®°å¾—å–æ°´ğŸš°","ç»™ä½ ä¸€ä¸ªæœŸå¾…âœ¨","æƒ³ä½ æ¯ä¸€åˆ»"
  ];

  let timerIds = [];
  const startBtn = document.querySelector('#startBtn');
  const stopBtn  = document.querySelector('#stopBtn');

  function rand(min, max){ return Math.floor(Math.random()*(max-min+1))+min; }

  function createPopup(ttl=2000){
    const box = document.createElement('div');
    box.className = 'popup';
    box.style.left = rand(0, Math.max(0, innerWidth - parseInt(getComputedStyle(document.documentElement).getPropertyValue('--popup-w')))) + 'px';
    box.style.top  = rand(0, Math.max(0, innerHeight - parseInt(getComputedStyle(document.documentElement).getPropertyValue('--popup-h')))) + 'px';
    box.style.transform += ` rotate(${rand(-4,4)}deg)`;
    box.style.opacity = 0.98;

    const span = document.createElement('div');
    span.className = 'txt';
    span.textContent = messages[rand(0, messages.length-1)];
    box.appendChild(span);

    // è½»è§¦å³å¯å…³é—­
    box.addEventListener('click', () => {
      box.style.animation = 'fade-out .18s ease forwards';
      setTimeout(()=> box.remove(), 180);
    }, {passive:true});

    document.body.appendChild(box);

    if (ttl > 0) {
      setTimeout(() => {
        if (!box.isConnected) return;
        box.style.animation = 'fade-out .18s ease forwards';
        setTimeout(()=> box.remove(), 180);
      }, ttl);
    }
  }

  function start() {
    stop(); // å…ˆæ¸…ç©ºæ—§å®šæ—¶å™¨
    const n = +document.querySelector('#count').value || 100;
    const gap = +document.querySelector('#gap').value || 50;
    const ttl = +document.querySelector('#ttl').value || 2000;

    for (let i = 0; i < n; i++) {
      const id = setTimeout(()=> createPopup(ttl), i * gap);
      timerIds.push(id);
    }
  }

  function stop() {
    timerIds.forEach(id => clearTimeout(id));
    timerIds = [];
    // ç§»é™¤æ‰€æœ‰å¼¹çª—
    document.querySelectorAll('.popup').forEach(p => p.remove());
  }

  startBtn.addEventListener('click', start);
  stopBtn.addEventListener('click', stop);

  // ç”µè„‘ç«¯æŒ‰ Esc ä¹Ÿèƒ½æ¸…ç©º
  window.addEventListener('keydown', e => { if (e.key === 'Escape') stop(); });
</script>
</body>
</html>